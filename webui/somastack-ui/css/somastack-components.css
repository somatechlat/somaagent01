/**
 * SomaStack Unified UI Design System - Component Styles
 * 
 * Document ID: SOMASTACK-UI-COMPONENTS
 * Version: 1.0.0
 * 
 * Component styles for the SomaStack platform.
 * 
 * Requirements: FR-NAV-001 through FR-MOD-007
 */

/* ============================================
 * LAYOUT COMPONENTS
 * Requirement: 12.4, 12.5
 * ============================================ */

.soma-layout {
  display: grid;
  grid-template-columns: var(--sidebar-width) 1fr;
  grid-template-rows: var(--header-height) 1fr var(--footer-height);
  grid-template-areas:
    "sidebar header"
    "sidebar main"
    "sidebar footer";
  min-height: 100vh;
  background-color: var(--bg-page);
}

.soma-layout--sidebar-collapsed {
  grid-template-columns: var(--sidebar-width-collapsed) 1fr;
}

/* Sidebar */
.soma-sidebar {
  grid-area: sidebar;
  display: flex;
  flex-direction: column;
  width: var(--sidebar-width);
  height: 100vh;
  position: sticky;
  top: 0;
  background-color: var(--bg-surface-1);
  border-right: 1px solid var(--border-subtle);
  transition: width var(--transition-normal);
  overflow: hidden;
}

.soma-sidebar--collapsed {
  width: var(--sidebar-width-collapsed);
}

.soma-sidebar__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4);
  border-bottom: 1px solid var(--border-subtle);
  min-height: var(--header-height);
}

.soma-sidebar__logo {
  height: 32px;
  width: auto;
}

.soma-sidebar__toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: var(--radius-md);
  color: var(--text-secondary);
  transition: background-color var(--transition-fast), color var(--transition-fast);
}

.soma-sidebar__toggle:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.soma-sidebar__content {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-2);
}

.soma-sidebar__footer {
  padding: var(--space-4);
  border-top: 1px solid var(--border-subtle);
}

/* Header */
.soma-header {
  grid-area: header;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-6);
  height: var(--header-height);
  background-color: var(--bg-surface-1);
  border-bottom: 1px solid var(--border-subtle);
  position: sticky;
  top: 0;
  z-index: var(--z-sticky);
}

.soma-header__title {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
}

.soma-header__actions {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

/* Main Content */
.soma-main {
  grid-area: main;
  padding: var(--space-6);
  overflow-y: auto;
  background-color: var(--bg-page);
}

.soma-main__container {
  max-width: var(--content-max-width);
  margin: 0 auto;
}

/* Footer */
.soma-footer {
  grid-area: footer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-6);
  height: var(--footer-height);
  background-color: var(--bg-surface-1);
  border-top: 1px solid var(--border-subtle);
  font-size: var(--text-sm);
  color: var(--text-muted);
}

/* ============================================
 * NAVIGATION COMPONENTS
 * Requirement: FR-NAV-001 through FR-NAV-006
 * ============================================ */

.soma-nav-group {
  margin-bottom: var(--space-4);
}

.soma-nav-group__label {
  display: block;
  padding: var(--space-2) var(--space-3);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
}

.soma-sidebar--collapsed .soma-nav-group__label {
  display: none;
}

.soma-nav-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  color: var(--text-secondary);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  transition: background-color var(--transition-fast), color var(--transition-fast);
  cursor: pointer;
  text-decoration: none;
}

.soma-nav-item:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.soma-nav-item:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: -2px;
}

.soma-nav-item--active {
  background-color: var(--color-primary-50);
  color: var(--color-primary-600);
}

.soma-dark .soma-nav-item--active {
  background-color: rgba(59, 130, 246, 0.15);
  color: var(--color-primary-500);
}

.soma-nav-item__icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

.soma-nav-item__label {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.soma-sidebar--collapsed .soma-nav-item__label {
  display: none;
}

.soma-nav-item__badge {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 20px;
  height: 20px;
  padding: 0 var(--space-1);
  background-color: var(--color-error-500);
  color: white;
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  border-radius: var(--radius-full);
}

.soma-sidebar--collapsed .soma-nav-item__badge {
  position: absolute;
  top: 2px;
  right: 2px;
  min-width: 16px;
  height: 16px;
  font-size: 10px;
}

.soma-sidebar--collapsed .soma-nav-item {
  position: relative;
  justify-content: center;
  padding: var(--space-3);
}

/* ============================================
 * STATS CARD COMPONENT
 * Requirement: FR-SC-001 through FR-SC-005
 * ============================================ */

.soma-stats-card {
  display: flex;
  flex-direction: column;
  padding: var(--space-4);
  background-color: var(--bg-surface-1);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  transition: box-shadow var(--transition-fast), transform var(--transition-fast);
}

.soma-stats-card:hover {
  box-shadow: var(--shadow-md);
}

.soma-stats-card--sm { min-width: 160px; }
.soma-stats-card--md { min-width: 200px; }
.soma-stats-card--lg { min-width: 280px; }
.soma-stats-card--full { width: 100%; }

.soma-stats-card__header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: var(--space-3);
}

.soma-stats-card__icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background-color: var(--color-primary-50);
  color: var(--color-primary-500);
  border-radius: var(--radius-md);
}

.soma-dark .soma-stats-card__icon {
  background-color: rgba(59, 130, 246, 0.15);
}

.soma-stats-card__value {
  font-size: var(--text-2xl);
  font-weight: var(--font-bold);
  color: var(--text-primary);
  line-height: var(--leading-tight);
  transition: color var(--transition-slow);
}

.soma-stats-card__label {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-top: var(--space-1);
}

.soma-stats-card__trend {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  margin-top: var(--space-2);
}

.soma-stats-card__trend--up {
  color: var(--color-success-500);
}

.soma-stats-card__trend--down {
  color: var(--color-error-500);
}

.soma-stats-card__trend--neutral {
  color: var(--text-muted);
}

/* Stats Grid */
.soma-stats-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-4);
}

@media (max-width: 1023px) {
  .soma-stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 639px) {
  .soma-stats-grid {
    grid-template-columns: 1fr;
  }
}

/* ============================================
 * DATA TABLE COMPONENT
 * Requirement: FR-TBL-001 through FR-TBL-008
 * ============================================ */

.soma-table-container {
  background-color: var(--bg-surface-1);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.soma-table__toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4);
  border-bottom: 1px solid var(--border-subtle);
  gap: var(--space-3);
}

.soma-table {
  width: 100%;
  border-collapse: collapse;
}

.soma-table th,
.soma-table td {
  padding: var(--space-3) var(--space-4);
  text-align: left;
  border-bottom: 1px solid var(--border-subtle);
}

.soma-table th {
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  color: var(--text-secondary);
  background-color: var(--bg-surface-2);
  white-space: nowrap;
}

.soma-table__header {
  cursor: pointer;
  user-select: none;
  transition: background-color var(--transition-fast);
}

.soma-table__header:hover {
  background-color: var(--bg-hover);
}

.soma-table__header--sorted {
  color: var(--text-primary);
}

.soma-table__header-content {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.soma-table__sort-icon {
  opacity: 0.5;
}

.soma-table__header--sorted .soma-table__sort-icon {
  opacity: 1;
}

.soma-table__row {
  transition: background-color var(--transition-fast);
}

.soma-table__row:hover {
  background-color: var(--bg-hover);
}

.soma-table__row--selected {
  background-color: var(--color-primary-50);
}

.soma-dark .soma-table__row--selected {
  background-color: rgba(59, 130, 246, 0.1);
}

.soma-table__checkbox {
  width: 40px;
}

.soma-table__actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  white-space: nowrap;
}

.soma-table__pagination {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3) var(--space-4);
  border-top: 1px solid var(--border-subtle);
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.soma-table__empty {
  padding: var(--space-12) var(--space-4);
  text-align: center;
  color: var(--text-muted);
}

.soma-table__empty-icon {
  font-size: 48px;
  margin-bottom: var(--space-4);
  opacity: 0.5;
}

/* Table Loading Skeleton */
.soma-table__skeleton {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

.soma-table__skeleton-row {
  height: 48px;
}

.soma-table__skeleton-cell {
  background-color: var(--bg-hover);
  border-radius: var(--radius-sm);
  height: 16px;
}

/* ============================================
 * STATUS BADGE COMPONENT
 * ============================================ */

.soma-badge {
  display: inline-flex;
  align-items: center;
  padding: var(--space-1) var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  border-radius: var(--radius-full);
  text-transform: capitalize;
}

.soma-badge--approved,
.soma-badge--success,
.soma-badge--healthy {
  background-color: var(--color-success-50);
  color: var(--color-success-600);
}

.soma-badge--pending,
.soma-badge--warning,
.soma-badge--degraded {
  background-color: var(--color-warning-50);
  color: var(--color-warning-600);
}

.soma-badge--rejected,
.soma-badge--error,
.soma-badge--down {
  background-color: var(--color-error-50);
  color: var(--color-error-600);
}

.soma-badge--info,
.soma-badge--unknown {
  background-color: var(--color-neutral-100);
  color: var(--color-neutral-600);
}

.soma-badge--primary {
  background-color: var(--color-primary-50);
  color: var(--color-primary-600);
}

/* Memory type badges */
.soma-badge--episodic {
  background-color: var(--color-primary-50);
  color: var(--color-primary-600);
}

.soma-badge--semantic {
  background-color: #f3e8ff;
  color: #7c3aed;
}

.soma-dark .soma-badge--semantic {
  background-color: rgba(124, 58, 237, 0.15);
}

/* ============================================
 * STATUS INDICATOR COMPONENT
 * Requirement: FR-SI-001 through FR-SI-007
 * ============================================ */

.soma-status {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  position: relative;
}

.soma-status__dot {
  width: 10px;
  height: 10px;
  border-radius: var(--radius-full);
  flex-shrink: 0;
}

.soma-status__dot--healthy {
  background-color: var(--status-healthy);
}

.soma-status__dot--degraded {
  background-color: var(--status-degraded);
}

.soma-status__dot--down {
  background-color: var(--status-down);
}

.soma-status__dot--unknown {
  background-color: var(--status-unknown);
}

.soma-status__dot--pulse {
  animation: statusPulse 2s infinite;
}

.soma-status__dot--healthy.soma-status__dot--pulse {
  color: var(--status-healthy);
}

.soma-status__dot--degraded.soma-status__dot--pulse {
  color: var(--status-degraded);
}

.soma-status__label {
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  color: var(--text-primary);
}

.soma-status__time {
  font-size: var(--text-xs);
  color: var(--text-muted);
}

.soma-status__tooltip {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  padding: var(--space-2) var(--space-3);
  background-color: var(--color-neutral-800);
  color: white;
  font-size: var(--text-xs);
  border-radius: var(--radius-md);
  white-space: nowrap;
  z-index: var(--z-tooltip);
  margin-bottom: var(--space-2);
  box-shadow: var(--shadow-lg);
}

.soma-status__tooltip::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-top-color: var(--color-neutral-800);
}


/* ========================================
   DATA TABLE
   ======================================== */
.soma-table-container {
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
  overflow: hidden;
}

.soma-table__toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--soma-space-4);
  padding: var(--soma-space-4);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-table {
  width: 100%;
  border-collapse: collapse;
}

.soma-table th,
.soma-table td {
  padding: var(--soma-space-3) var(--soma-space-4);
  text-align: left;
}

.soma-table th {
  font-size: var(--soma-text-xs);
  font-weight: var(--soma-font-semibold);
  color: var(--soma-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  background: var(--soma-bg-muted);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-table__header {
  cursor: pointer;
  user-select: none;
  transition: color var(--soma-transition-fast);
}

.soma-table__header:hover {
  color: var(--soma-text-primary);
}

.soma-table__header--sorted {
  color: var(--soma-primary-600);
}

.soma-table__row {
  border-bottom: 1px solid var(--soma-border-subtle);
  transition: background var(--soma-transition-fast);
}

.soma-table__row:last-child {
  border-bottom: none;
}

.soma-table__row:hover {
  background: var(--soma-bg-surface-hover);
}

.soma-table__row--selected {
  background: var(--soma-primary-50);
}

.soma-dark .soma-table__row--selected {
  background: rgba(59, 130, 246, 0.1);
}

.soma-table td {
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
}

.soma-table__checkbox {
  width: 40px;
}

.soma-table__actions {
  display: flex;
  align-items: center;
  gap: var(--soma-space-1);
}

.soma-table__pagination {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-3) var(--soma-space-4);
  border-top: 1px solid var(--soma-border-subtle);
  font-size: var(--soma-text-sm);
  color: var(--soma-text-secondary);
}

.soma-table__empty {
  padding: var(--soma-space-12) var(--soma-space-4);
  text-align: center;
  color: var(--soma-text-muted);
}

.soma-table__empty-icon {
  font-size: 48px;
  margin-bottom: var(--soma-space-4);
  opacity: 0.5;
}

/* ========================================
   FORMS
   ======================================== */
.soma-form-group {
  margin-bottom: var(--soma-space-4);
}

.soma-label {
  display: block;
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-medium);
  color: var(--soma-text-primary);
  margin-bottom: var(--soma-space-2);
}

.soma-input {
  display: block;
  width: 100%;
  padding: var(--soma-space-2) var(--soma-space-3);
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-default);
  border-radius: var(--soma-radius-md);
  transition: all var(--soma-transition-fast);
}

.soma-input:hover {
  border-color: var(--soma-border-strong);
}

.soma-input:focus {
  border-color: var(--soma-primary-500);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.soma-input::placeholder {
  color: var(--soma-text-muted);
}

.soma-input:disabled {
  background: var(--soma-bg-muted);
  cursor: not-allowed;
  opacity: 0.6;
}

.soma-input--error {
  border-color: var(--soma-error-500);
}

.soma-input--error:focus {
  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
}

.soma-input--search {
  padding-left: var(--soma-space-10);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23737373' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.3-4.3'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: var(--soma-space-3) center;
}

.soma-textarea {
  display: block;
  width: 100%;
  min-height: 100px;
  padding: var(--soma-space-3);
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-default);
  border-radius: var(--soma-radius-md);
  resize: vertical;
  transition: all var(--soma-transition-fast);
}

.soma-textarea:focus {
  border-color: var(--soma-primary-500);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.soma-select {
  display: block;
  width: 100%;
  padding: var(--soma-space-2) var(--soma-space-3);
  padding-right: var(--soma-space-10);
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-default);
  border-radius: var(--soma-radius-md);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23737373' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right var(--soma-space-3) center;
  cursor: pointer;
  transition: all var(--soma-transition-fast);
}

.soma-select:focus {
  border-color: var(--soma-primary-500);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.soma-helper-text {
  display: block;
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
  margin-top: var(--soma-space-1);
}

.soma-error-text {
  display: block;
  font-size: var(--soma-text-xs);
  color: var(--soma-error-600);
  margin-top: var(--soma-space-1);
}

/* Checkbox */
.soma-checkbox {
  display: inline-flex;
  align-items: center;
  gap: var(--soma-space-2);
  cursor: pointer;
}

.soma-checkbox__input {
  width: 16px;
  height: 16px;
  border: 1px solid var(--soma-border-default);
  border-radius: var(--soma-radius-sm);
  appearance: none;
  cursor: pointer;
  transition: all var(--soma-transition-fast);
}

.soma-checkbox__input:checked {
  background: var(--soma-primary-600);
  border-color: var(--soma-primary-600);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
}

.soma-checkbox__label {
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
}

/* Toggle */
.soma-toggle {
  display: inline-flex;
  align-items: center;
  gap: var(--soma-space-3);
  cursor: pointer;
}

.soma-toggle__track {
  position: relative;
  width: 44px;
  height: 24px;
  background: var(--soma-neutral-300);
  border-radius: var(--soma-radius-full);
  transition: background var(--soma-transition-fast);
}

.soma-toggle__input:checked + .soma-toggle__track {
  background: var(--soma-primary-600);
}

.soma-toggle__thumb {
  position: absolute;
  top: 2px;
  left: 2px;
  width: 20px;
  height: 20px;
  background: white;
  border-radius: var(--soma-radius-full);
  box-shadow: var(--soma-shadow-sm);
  transition: transform var(--soma-transition-fast);
}

.soma-toggle__input:checked + .soma-toggle__track .soma-toggle__thumb {
  transform: translateX(20px);
}

.soma-toggle__input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.soma-toggle__label {
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
}

/* ========================================
   MODAL
   ======================================== */
.soma-modal {
  position: fixed;
  inset: 0;
  z-index: var(--soma-z-modal);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--soma-space-4);
}

.soma-modal__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.soma-modal__content {
  position: relative;
  width: 100%;
  max-height: calc(100vh - var(--soma-space-8));
  background: var(--soma-bg-surface);
  border-radius: var(--soma-radius-xl);
  box-shadow: var(--soma-shadow-xl);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.soma-modal__content--sm { max-width: 400px; }
.soma-modal__content--md { max-width: 600px; }
.soma-modal__content--lg { max-width: 800px; }
.soma-modal__content--full { max-width: calc(100vw - var(--soma-space-8)); }

.soma-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-4) var(--soma-space-5);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-modal__title {
  font-size: var(--soma-text-lg);
  font-weight: var(--soma-font-semibold);
  color: var(--soma-text-primary);
}

.soma-modal__close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: var(--soma-radius-md);
  color: var(--soma-text-muted);
  transition: all var(--soma-transition-fast);
}

.soma-modal__close:hover {
  background: var(--soma-bg-surface-hover);
  color: var(--soma-text-primary);
}

.soma-modal__body {
  flex: 1;
  padding: var(--soma-space-5);
  overflow-y: auto;
}

.soma-modal__footer {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: var(--soma-space-3);
  padding: var(--soma-space-4) var(--soma-space-5);
  border-top: 1px solid var(--soma-border-subtle);
}

/* Modal Animations */
.soma-modal--enter {
  animation: soma-modal-enter 200ms ease-out;
}

.soma-modal--leave {
  animation: soma-modal-leave 150ms ease-in;
}

@keyframes soma-modal-enter {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes soma-modal-leave {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.soma-modal__content--enter {
  animation: soma-modal-content-enter 200ms ease-out;
}

@keyframes soma-modal-content-enter {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* ========================================
   TOAST
   ======================================== */
.soma-toast-container {
  position: fixed;
  top: var(--soma-space-4);
  right: var(--soma-space-4);
  z-index: var(--soma-z-toast);
  display: flex;
  flex-direction: column;
  gap: var(--soma-space-3);
  max-width: 400px;
}

.soma-toast {
  display: flex;
  align-items: flex-start;
  gap: var(--soma-space-3);
  padding: var(--soma-space-4);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
  box-shadow: var(--soma-shadow-lg);
  animation: soma-toast-enter 200ms ease-out;
}

@keyframes soma-toast-enter {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.soma-toast__icon {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
}

.soma-toast--info .soma-toast__icon { color: var(--soma-primary-500); }
.soma-toast--success .soma-toast__icon { color: var(--soma-success-500); }
.soma-toast--warning .soma-toast__icon { color: var(--soma-warning-500); }
.soma-toast--error .soma-toast__icon { color: var(--soma-error-500); }

.soma-toast__message {
  flex: 1;
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
}

.soma-toast__close {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  color: var(--soma-text-muted);
  border-radius: var(--soma-radius-sm);
  transition: all var(--soma-transition-fast);
}

.soma-toast__close:hover {
  background: var(--soma-bg-surface-hover);
  color: var(--soma-text-primary);
}

/* ========================================
   SKELETON LOADING
   ======================================== */
.soma-skeleton {
  background: linear-gradient(
    90deg,
    var(--soma-neutral-200) 25%,
    var(--soma-neutral-100) 50%,
    var(--soma-neutral-200) 75%
  );
  background-size: 200% 100%;
  animation: soma-skeleton-shimmer 1.5s infinite;
  border-radius: var(--soma-radius-md);
}

.soma-dark .soma-skeleton {
  background: linear-gradient(
    90deg,
    var(--soma-neutral-800) 25%,
    var(--soma-neutral-700) 50%,
    var(--soma-neutral-800) 75%
  );
  background-size: 200% 100%;
}

@keyframes soma-skeleton-shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

.soma-skeleton--text {
  height: 1em;
  width: 100%;
}

.soma-skeleton--title {
  height: 1.5em;
  width: 60%;
}

.soma-skeleton--avatar {
  width: 40px;
  height: 40px;
  border-radius: var(--soma-radius-full);
}

.soma-skeleton--card {
  height: 120px;
}

/* ========================================
   SPINNER
   ======================================== */
.soma-spinner {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 2px solid var(--soma-border-default);
  border-top-color: var(--soma-primary-500);
  border-radius: var(--soma-radius-full);
  animation: soma-spin 0.8s linear infinite;
}

.soma-spinner--sm {
  width: 16px;
  height: 16px;
  border-width: 2px;
}

.soma-spinner--lg {
  width: 32px;
  height: 32px;
  border-width: 3px;
}

@keyframes soma-spin {
  to { transform: rotate(360deg); }
}

/* ========================================
   RESPONSIVE - MOBILE
   ======================================== */
@media (max-width: 639px) {
  .soma-layout {
    grid-template-columns: 1fr;
    grid-template-rows: var(--soma-header-height) 1fr auto;
    grid-template-areas:
      "header"
      "main"
      "nav";
  }

  .soma-sidebar {
    display: none;
  }

  .soma-bottom-nav {
    grid-area: nav;
    display: flex;
    align-items: center;
    justify-content: space-around;
    height: 64px;
    background: var(--soma-glass-bg-strong);
    backdrop-filter: var(--soma-glass-blur);
    border-top: 1px solid var(--soma-glass-border-subtle);
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: var(--soma-z-fixed);
  }

  .soma-bottom-nav__item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--soma-space-1);
    padding: var(--soma-space-2);
    color: var(--soma-text-secondary);
    font-size: var(--soma-text-xs);
    min-width: 64px;
  }

  .soma-bottom-nav__item--active {
    color: var(--soma-primary-600);
  }

  .soma-main {
    padding: var(--soma-space-4);
    padding-bottom: calc(64px + var(--soma-space-4));
  }
}

/* ========================================
   RESPONSIVE - TABLET
   ======================================== */
@media (min-width: 640px) and (max-width: 1023px) {
  .soma-layout {
    grid-template-columns: var(--soma-sidebar-collapsed-width) 1fr;
  }

  .soma-sidebar {
    width: var(--soma-sidebar-collapsed-width);
  }

  .soma-sidebar__logo-text,
  .soma-nav-group__label,
  .soma-nav-item__label {
    display: none;
  }

  .soma-nav-item {
    justify-content: center;
    padding: var(--soma-space-3);
  }

  .soma-bottom-nav {
    display: none;
  }
}

/* ========================================
   RESPONSIVE - DESKTOP
   ======================================== */
@media (min-width: 1024px) {
  .soma-bottom-nav {
    display: none;
  }
}


/* ============================================
 * BUTTON COMPONENTS
 * ============================================ */

.soma-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  line-height: var(--leading-normal);
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  cursor: pointer;
  transition: background-color var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), box-shadow var(--transition-fast);
  white-space: nowrap;
  user-select: none;
}

.soma-btn:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}

.soma-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Primary Button */
.soma-btn--primary {
  background-color: var(--interactive-primary);
  color: white;
  border-color: var(--interactive-primary);
}

.soma-btn--primary:hover:not(:disabled) {
  background-color: var(--interactive-primary-hover);
  border-color: var(--interactive-primary-hover);
}

.soma-btn--primary:active:not(:disabled) {
  background-color: var(--interactive-primary-active);
  border-color: var(--interactive-primary-active);
}

/* Secondary Button */
.soma-btn--secondary {
  background-color: var(--bg-surface-1);
  color: var(--text-primary);
  border-color: var(--border-default);
}

.soma-btn--secondary:hover:not(:disabled) {
  background-color: var(--bg-hover);
  border-color: var(--border-default);
}

/* Ghost Button */
.soma-btn--ghost {
  background-color: transparent;
  color: var(--text-secondary);
  border-color: transparent;
}

.soma-btn--ghost:hover:not(:disabled) {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

/* Danger Button */
.soma-btn--danger {
  background-color: var(--interactive-danger);
  color: white;
  border-color: var(--interactive-danger);
}

.soma-btn--danger:hover:not(:disabled) {
  background-color: var(--interactive-danger-hover);
  border-color: var(--interactive-danger-hover);
}

/* Button Sizes */
.soma-btn--sm {
  padding: var(--space-1) var(--space-2);
  font-size: var(--text-xs);
}

.soma-btn--lg {
  padding: var(--space-3) var(--space-6);
  font-size: var(--text-base);
}

/* Icon Button */
.soma-btn--icon {
  padding: var(--space-2);
  width: 36px;
  height: 36px;
}

.soma-btn--icon.soma-btn--sm {
  width: 28px;
  height: 28px;
  padding: var(--space-1);
}

/* ============================================
 * FORM COMPONENTS
 * Requirement: FR-FRM-001 through FR-FRM-007
 * ============================================ */

.soma-form-group {
  margin-bottom: var(--space-4);
}

.soma-label {
  display: block;
  margin-bottom: var(--space-2);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  color: var(--text-primary);
}

.soma-label--required::after {
  content: ' *';
  color: var(--color-error-500);
}

/* Text Input */
.soma-input {
  display: block;
  width: 100%;
  padding: var(--space-2) var(--space-3);
  font-size: var(--text-sm);
  line-height: var(--leading-normal);
  color: var(--text-primary);
  background-color: var(--bg-surface-1);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.soma-input::placeholder {
  color: var(--text-muted);
}

.soma-input:hover:not(:disabled):not(:focus) {
  border-color: var(--color-neutral-400);
}

.soma-input:focus {
  border-color: var(--border-focus);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  outline: none;
}

.soma-input:disabled {
  background-color: var(--bg-hover);
  cursor: not-allowed;
  opacity: 0.7;
}

.soma-input:read-only {
  background-color: var(--bg-hover);
}

.soma-input--error {
  border-color: var(--color-error-500);
}

.soma-input--error:focus {
  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
}

/* Search Input */
.soma-input--search {
  padding-left: var(--space-8);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23737373' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.3-4.3'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: var(--space-3) center;
}

/* Textarea */
.soma-textarea {
  display: block;
  width: 100%;
  min-height: 100px;
  padding: var(--space-2) var(--space-3);
  font-size: var(--text-sm);
  line-height: var(--leading-normal);
  color: var(--text-primary);
  background-color: var(--bg-surface-1);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  resize: vertical;
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.soma-textarea:focus {
  border-color: var(--border-focus);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  outline: none;
}

/* Select */
.soma-select {
  display: block;
  width: 100%;
  padding: var(--space-2) var(--space-8) var(--space-2) var(--space-3);
  font-size: var(--text-sm);
  line-height: var(--leading-normal);
  color: var(--text-primary);
  background-color: var(--bg-surface-1);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23737373' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right var(--space-3) center;
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  cursor: pointer;
  appearance: none;
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.soma-select:focus {
  border-color: var(--border-focus);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  outline: none;
}

/* Checkbox */
.soma-checkbox {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  cursor: pointer;
}

.soma-checkbox__input {
  width: 18px;
  height: 18px;
  border: 1px solid var(--border-default);
  border-radius: var(--radius-sm);
  background-color: var(--bg-surface-1);
  cursor: pointer;
  appearance: none;
  transition: background-color var(--transition-fast), border-color var(--transition-fast);
}

.soma-checkbox__input:checked {
  background-color: var(--interactive-primary);
  border-color: var(--interactive-primary);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
}

.soma-checkbox__input:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}

.soma-checkbox__label {
  font-size: var(--text-sm);
  color: var(--text-primary);
}

/* Toggle Switch */
.soma-toggle {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  cursor: pointer;
}

.soma-toggle__input {
  position: relative;
  width: 44px;
  height: 24px;
  background-color: var(--color-neutral-300);
  border-radius: var(--radius-full);
  cursor: pointer;
  appearance: none;
  transition: background-color var(--transition-fast);
}

.soma-toggle__input::after {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 20px;
  height: 20px;
  background-color: white;
  border-radius: var(--radius-full);
  box-shadow: var(--shadow-sm);
  transition: transform var(--transition-fast);
}

.soma-toggle__input:checked {
  background-color: var(--interactive-primary);
}

.soma-toggle__input:checked::after {
  transform: translateX(20px);
}

.soma-toggle__input:focus-visible {
  outline: 2px solid var(--border-focus);
  outline-offset: 2px;
}

/* Helper Text */
.soma-helper-text {
  margin-top: var(--space-1);
  font-size: var(--text-xs);
  color: var(--text-muted);
}

.soma-helper-text--error {
  color: var(--color-error-500);
}

/* ============================================
 * MODAL COMPONENT
 * Requirement: FR-MOD-001 through FR-MOD-007
 * ============================================ */

.soma-modal {
  position: fixed;
  inset: 0;
  z-index: var(--z-modal);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-4);
}

.soma-modal__backdrop {
  position: absolute;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.soma-modal__content {
  position: relative;
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - var(--space-8));
  background-color: var(--bg-surface-1);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  overflow: hidden;
}

.soma-modal__content--sm { width: 100%; max-width: 400px; }
.soma-modal__content--md { width: 100%; max-width: 600px; }
.soma-modal__content--lg { width: 100%; max-width: 800px; }
.soma-modal__content--full { width: 100%; max-width: calc(100vw - var(--space-8)); height: calc(100vh - var(--space-8)); }

.soma-modal__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-6);
  border-bottom: 1px solid var(--border-subtle);
}

.soma-modal__title {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
}

.soma-modal__close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: var(--radius-md);
  color: var(--text-muted);
  transition: background-color var(--transition-fast), color var(--transition-fast);
}

.soma-modal__close:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.soma-modal__body {
  flex: 1;
  padding: var(--space-6);
  overflow-y: auto;
}

.soma-modal__footer {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: var(--space-3);
  padding: var(--space-4) var(--space-6);
  border-top: 1px solid var(--border-subtle);
}

/* Modal Animations */
.soma-modal--enter {
  animation: fadeIn 200ms ease;
}

.soma-modal--enter .soma-modal__content {
  animation: scaleIn 200ms ease;
}

.soma-modal--leave {
  animation: fadeOut 200ms ease;
}

/* ============================================
 * TOAST COMPONENT
 * Requirement: FR-TST-001 through FR-TST-004
 * ============================================ */

.soma-toast-container {
  position: fixed;
  top: var(--space-4);
  right: var(--space-4);
  z-index: var(--z-toast);
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  max-width: 400px;
  pointer-events: none;
}

.soma-toast {
  display: flex;
  align-items: flex-start;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  background-color: var(--bg-surface-1);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  pointer-events: auto;
  animation: slideInDown 200ms ease;
}

.soma-toast--info {
  border-left: 4px solid var(--color-primary-500);
}

.soma-toast--success {
  border-left: 4px solid var(--color-success-500);
}

.soma-toast--warning {
  border-left: 4px solid var(--color-warning-500);
}

.soma-toast--error {
  border-left: 4px solid var(--color-error-500);
}

.soma-toast__icon {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
}

.soma-toast--info .soma-toast__icon { color: var(--color-primary-500); }
.soma-toast--success .soma-toast__icon { color: var(--color-success-500); }
.soma-toast--warning .soma-toast__icon { color: var(--color-warning-500); }
.soma-toast--error .soma-toast__icon { color: var(--color-error-500); }

.soma-toast__content {
  flex: 1;
  min-width: 0;
}

.soma-toast__title {
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
}

.soma-toast__message {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-top: var(--space-1);
}

.soma-toast__close {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  transition: background-color var(--transition-fast), color var(--transition-fast);
}

.soma-toast__close:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

/* ============================================
 * PAGINATION COMPONENT
 * ============================================ */

.soma-pagination {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.soma-pagination__btn {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 32px;
  height: 32px;
  padding: 0 var(--space-2);
  font-size: var(--text-sm);
  color: var(--text-secondary);
  background-color: transparent;
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  transition: background-color var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast);
}

.soma-pagination__btn:hover:not(:disabled) {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.soma-pagination__btn--active {
  background-color: var(--interactive-primary);
  border-color: var(--interactive-primary);
  color: white;
}

.soma-pagination__btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.soma-pagination__info {
  font-size: var(--text-sm);
  color: var(--text-muted);
  margin: 0 var(--space-2);
}

/* ============================================
 * LOADING SKELETON
 * ============================================ */

.soma-skeleton {
  background: linear-gradient(90deg, var(--bg-hover) 25%, var(--bg-surface-2) 50%, var(--bg-hover) 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  border-radius: var(--radius-sm);
}

@keyframes skeleton-loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

.soma-skeleton--text {
  height: 16px;
  width: 100%;
}

.soma-skeleton--title {
  height: 24px;
  width: 60%;
}

.soma-skeleton--avatar {
  width: 40px;
  height: 40px;
  border-radius: var(--radius-full);
}

.soma-skeleton--card {
  height: 120px;
  width: 100%;
}

/* ============================================
 * SPINNER
 * ============================================ */

.soma-spinner {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 2px solid var(--border-default);
  border-top-color: var(--interactive-primary);
  border-radius: var(--radius-full);
  animation: spin 0.8s linear infinite;
}

.soma-spinner--sm {
  width: 16px;
  height: 16px;
  border-width: 2px;
}

.soma-spinner--lg {
  width: 32px;
  height: 32px;
  border-width: 3px;
}

/* ============================================
 * RESPONSIVE LAYOUT
 * Requirement: 12.1, 12.2, 12.3
 * ============================================ */

/* Tablet: Collapsed sidebar */
@media (max-width: 1023px) {
  .soma-layout {
    grid-template-columns: var(--sidebar-width-collapsed) 1fr;
  }
  
  .soma-sidebar {
    width: var(--sidebar-width-collapsed);
  }
  
  .soma-sidebar__logo {
    display: none;
  }
  
  .soma-nav-group__label {
    display: none;
  }
  
  .soma-nav-item {
    justify-content: center;
    padding: var(--space-3);
  }
  
  .soma-nav-item__label {
    display: none;
  }
}

/* Mobile: Bottom navigation */
@media (max-width: 639px) {
  .soma-layout {
    grid-template-columns: 1fr;
    grid-template-rows: var(--header-height) 1fr auto;
    grid-template-areas:
      "header"
      "main"
      "footer";
  }
  
  .soma-sidebar {
    display: none;
  }
  
  .soma-bottom-nav {
    display: flex;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 64px;
    background-color: var(--bg-surface-1);
    border-top: 1px solid var(--border-subtle);
    z-index: var(--z-fixed);
  }
  
  .soma-bottom-nav__item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-1);
    color: var(--text-muted);
    font-size: var(--text-xs);
    transition: color var(--transition-fast);
  }
  
  .soma-bottom-nav__item--active {
    color: var(--interactive-primary);
  }
  
  .soma-main {
    padding: var(--space-4);
    padding-bottom: calc(64px + var(--space-4));
  }
  
  .soma-footer {
    display: none;
  }
  
  /* Touch target size - Requirement: 12.6 */
  .soma-btn,
  .soma-nav-item,
  .soma-bottom-nav__item {
    min-height: 44px;
    min-width: 44px;
  }
}

/* Hide bottom nav on desktop */
@media (min-width: 640px) {
  .soma-bottom-nav {
    display: none;
  }
}


/* ============================================
 * AGENT DASHBOARD COMPONENTS
 * Requirement: FR-AGT-001 through FR-AGT-007
 * ============================================ */

/* Neuromodulator Gauge */
.soma-neuro-gauge {
  display: flex;
  flex-direction: column;
  gap: var(--soma-space-2);
  padding: var(--soma-space-3);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
}

.soma-neuro-gauge__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.soma-neuro-gauge__name {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-medium);
  color: var(--soma-text-primary);
}

.soma-neuro-gauge__value {
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-semibold);
  color: var(--soma-text-secondary);
}

.soma-neuro-gauge__bar {
  height: 8px;
  background: var(--soma-neutral-200);
  border-radius: var(--soma-radius-full);
  overflow: hidden;
}

.soma-dark .soma-neuro-gauge__bar {
  background: var(--soma-neutral-700);
}

.soma-neuro-gauge__fill {
  height: 100%;
  border-radius: var(--soma-radius-full);
  transition: width var(--soma-transition-normal);
}

.soma-neuro-gauge--dopamine .soma-neuro-gauge__fill {
  background: linear-gradient(90deg, #f59e0b, #fbbf24);
}

.soma-neuro-gauge--serotonin .soma-neuro-gauge__fill {
  background: linear-gradient(90deg, #3b82f6, #60a5fa);
}

.soma-neuro-gauge--noradrenaline .soma-neuro-gauge__fill {
  background: linear-gradient(90deg, #ef4444, #f87171);
}

.soma-neuro-gauge--acetylcholine .soma-neuro-gauge__fill {
  background: linear-gradient(90deg, #22c55e, #4ade80);
}

.soma-neuro-gauge--low .soma-neuro-gauge__value { color: var(--soma-warning-600); }
.soma-neuro-gauge--high .soma-neuro-gauge__value { color: var(--soma-success-600); }

/* Neuromodulator Panel */
.soma-neuro-panel {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--soma-space-3);
}

@media (max-width: 639px) {
  .soma-neuro-panel {
    grid-template-columns: 1fr;
  }
}

/* FSM State Diagram */
.soma-fsm-diagram {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
  padding: var(--soma-space-4);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
  overflow-x: auto;
}

.soma-fsm-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--soma-space-1);
  padding: var(--soma-space-2) var(--soma-space-3);
  border-radius: var(--soma-radius-md);
  background: var(--soma-bg-muted);
  min-width: 80px;
  transition: all var(--soma-transition-fast);
}

.soma-fsm-state__icon {
  font-size: 20px;
}

.soma-fsm-state__label {
  font-size: var(--soma-text-xs);
  font-weight: var(--soma-font-medium);
  color: var(--soma-text-secondary);
  text-transform: capitalize;
}

.soma-fsm-state--active {
  background: var(--soma-primary-100);
  border: 2px solid var(--soma-primary-500);
}

.soma-dark .soma-fsm-state--active {
  background: rgba(59, 130, 246, 0.2);
}

.soma-fsm-state--active .soma-fsm-state__label {
  color: var(--soma-primary-700);
}

.soma-dark .soma-fsm-state--active .soma-fsm-state__label {
  color: var(--soma-primary-400);
}

.soma-fsm-state--complete {
  background: var(--soma-success-50);
}

.soma-fsm-state--complete .soma-fsm-state__label {
  color: var(--soma-success-700);
}

.soma-fsm-state--error {
  background: var(--soma-error-50);
  border: 2px solid var(--soma-error-500);
}

.soma-fsm-state--error .soma-fsm-state__label {
  color: var(--soma-error-700);
}

.soma-fsm-arrow {
  color: var(--soma-text-muted);
  font-size: var(--soma-text-lg);
}

/* Reasoning Stream */
.soma-reasoning-stream {
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
  overflow: hidden;
}

.soma-reasoning-stream__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-3) var(--soma-space-4);
  border-bottom: 1px solid var(--soma-border-subtle);
  background: var(--soma-bg-muted);
}

.soma-reasoning-stream__title {
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-semibold);
  color: var(--soma-text-primary);
}

.soma-reasoning-stream__indicator {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
}

.soma-reasoning-stream__indicator--active {
  color: var(--soma-success-600);
}

.soma-reasoning-stream__content {
  padding: var(--soma-space-4);
  max-height: 300px;
  overflow-y: auto;
  font-family: var(--soma-font-mono);
  font-size: var(--soma-text-sm);
  line-height: var(--soma-leading-relaxed);
  color: var(--soma-text-primary);
  white-space: pre-wrap;
}

.soma-reasoning-chunk {
  margin-bottom: var(--soma-space-1);
}

.soma-reasoning-chunk--thinking {
  color: var(--soma-text-secondary);
}

.soma-reasoning-chunk--tool {
  color: var(--soma-primary-600);
}

/* Conversation History */
.soma-conversation {
  display: flex;
  flex-direction: column;
  gap: var(--soma-space-3);
  padding: var(--soma-space-4);
  max-height: 400px;
  overflow-y: auto;
}

.soma-message {
  display: flex;
  gap: var(--soma-space-3);
  max-width: 85%;
}

.soma-message--user {
  align-self: flex-end;
  flex-direction: row-reverse;
}

.soma-message--assistant {
  align-self: flex-start;
}

.soma-message--system {
  align-self: center;
  max-width: 100%;
}

.soma-message__avatar {
  flex-shrink: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--soma-bg-muted);
  border-radius: var(--soma-radius-full);
  font-size: var(--soma-text-sm);
}

.soma-message__bubble {
  padding: var(--soma-space-3);
  border-radius: var(--soma-radius-lg);
  font-size: var(--soma-text-sm);
  line-height: var(--soma-leading-normal);
}

.soma-message--user .soma-message__bubble {
  background: var(--soma-primary-600);
  color: white;
  border-bottom-right-radius: var(--soma-radius-sm);
}

.soma-message--assistant .soma-message__bubble {
  background: var(--soma-bg-muted);
  color: var(--soma-text-primary);
  border-bottom-left-radius: var(--soma-radius-sm);
}

.soma-message--system .soma-message__bubble {
  background: var(--soma-warning-50);
  color: var(--soma-warning-700);
  font-size: var(--soma-text-xs);
  text-align: center;
}

.soma-message--error .soma-message__bubble {
  background: var(--soma-error-50);
  color: var(--soma-error-700);
}

.soma-message__time {
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
  margin-top: var(--soma-space-1);
}

/* Tool Monitor */
.soma-tool-monitor {
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
}

.soma-tool-monitor__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-3) var(--soma-space-4);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-tool-monitor__list {
  max-height: 250px;
  overflow-y: auto;
}

.soma-tool-execution {
  display: flex;
  align-items: center;
  gap: var(--soma-space-3);
  padding: var(--soma-space-3) var(--soma-space-4);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-tool-execution:last-child {
  border-bottom: none;
}

.soma-tool-execution__icon {
  flex-shrink: 0;
  font-size: var(--soma-text-lg);
}

.soma-tool-execution__info {
  flex: 1;
  min-width: 0;
}

.soma-tool-execution__name {
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-medium);
  color: var(--soma-text-primary);
}

.soma-tool-execution__duration {
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
}

.soma-tool-status--running { color: var(--soma-warning-500); }
.soma-tool-status--success { color: var(--soma-success-500); }
.soma-tool-status--error { color: var(--soma-error-500); }

/* ============================================
 * MEMORY BROWSER COMPONENTS
 * Requirement: FR-MEM-001 through FR-MEM-007
 * ============================================ */

.soma-memory-browser {
  display: flex;
  flex-direction: column;
  gap: var(--soma-space-4);
}

.soma-memory-browser__toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--soma-space-4);
  flex-wrap: wrap;
}

.soma-memory-browser__search {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
  flex: 1;
  min-width: 200px;
}

.soma-memory-browser__view-toggle {
  display: flex;
  align-items: center;
  gap: var(--soma-space-1);
  background: var(--soma-bg-muted);
  border-radius: var(--soma-radius-md);
  padding: var(--soma-space-1);
}

.soma-memory-browser__view-btn {
  padding: var(--soma-space-2);
  border-radius: var(--soma-radius-sm);
  color: var(--soma-text-muted);
  transition: all var(--soma-transition-fast);
}

.soma-memory-browser__view-btn--active {
  background: var(--soma-bg-surface);
  color: var(--soma-text-primary);
  box-shadow: var(--soma-shadow-sm);
}

/* Memory Grid (Card View) */
.soma-memory-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: var(--soma-space-4);
}

/* Memory Card */
.soma-memory-card {
  display: flex;
  flex-direction: column;
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
  overflow: hidden;
  cursor: pointer;
  transition: all var(--soma-transition-fast);
}

.soma-memory-card:hover {
  border-color: var(--soma-primary-300);
  box-shadow: var(--soma-shadow-md);
}

.soma-memory-card__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-3);
  border-bottom: 1px solid var(--soma-border-subtle);
  background: var(--soma-bg-muted);
}

.soma-memory-card__type {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
}

.soma-memory-card__age {
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
}

.soma-memory-card__content {
  padding: var(--soma-space-3);
  flex: 1;
}

.soma-memory-card__preview {
  font-size: var(--soma-text-sm);
  color: var(--soma-text-primary);
  line-height: var(--soma-leading-relaxed);
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.soma-memory-card__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-2) var(--soma-space-3);
  border-top: 1px solid var(--soma-border-subtle);
  background: var(--soma-bg-muted);
}

.soma-memory-card__coord {
  font-family: var(--soma-font-mono);
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
}

.soma-memory-card__score {
  font-size: var(--soma-text-xs);
  font-weight: var(--soma-font-semibold);
  color: var(--soma-primary-600);
}

/* Memory Badges */
.soma-memory-badge--episodic {
  background: var(--soma-primary-50);
  color: var(--soma-primary-700);
}

.soma-memory-badge--semantic {
  background: #f3e8ff;
  color: #7c3aed;
}

.soma-dark .soma-memory-badge--semantic {
  background: rgba(124, 58, 237, 0.15);
  color: #a78bfa;
}

/* Memory Decay Indicator */
.soma-memory-decay {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
}

.soma-memory-decay__bar {
  width: 40px;
  height: 4px;
  background: var(--soma-neutral-200);
  border-radius: var(--soma-radius-full);
  overflow: hidden;
}

.soma-memory-decay__fill {
  height: 100%;
  border-radius: var(--soma-radius-full);
  transition: width var(--soma-transition-normal);
}

.soma-memory-decay--fresh .soma-memory-decay__fill {
  background: var(--soma-success-500);
}

.soma-memory-decay--aging .soma-memory-decay__fill {
  background: var(--soma-warning-500);
}

.soma-memory-decay--fading .soma-memory-decay__fill {
  background: var(--soma-error-500);
}

/* Memory Detail Panel */
.soma-memory-detail {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  max-width: 500px;
  background: var(--soma-bg-surface);
  border-left: 1px solid var(--soma-border-subtle);
  box-shadow: var(--soma-shadow-xl);
  z-index: var(--soma-z-modal);
  display: flex;
  flex-direction: column;
}

.soma-memory-detail__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--soma-space-4);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-memory-detail__tabs {
  display: flex;
  gap: var(--soma-space-1);
  padding: 0 var(--soma-space-4);
  border-bottom: 1px solid var(--soma-border-subtle);
}

.soma-memory-detail__tab {
  padding: var(--soma-space-3) var(--soma-space-4);
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-medium);
  color: var(--soma-text-secondary);
  border-bottom: 2px solid transparent;
  transition: all var(--soma-transition-fast);
}

.soma-memory-detail__tab:hover {
  color: var(--soma-text-primary);
}

.soma-memory-detail__tab--active {
  color: var(--soma-primary-600);
  border-bottom-color: var(--soma-primary-600);
}

.soma-memory-detail__content {
  flex: 1;
  padding: var(--soma-space-4);
  overflow-y: auto;
}

.soma-memory-detail__actions {
  display: flex;
  gap: var(--soma-space-3);
  padding: var(--soma-space-4);
  border-top: 1px solid var(--soma-border-subtle);
}

/* ============================================
 * VOICE INTERFACE COMPONENTS
 * Requirement: FR-VOI-001 through FR-VOI-006
 * ============================================ */

.soma-voice-interface {
  display: flex;
  flex-direction: column;
  gap: var(--soma-space-4);
  padding: var(--soma-space-4);
  background: var(--soma-bg-surface);
  border: 1px solid var(--soma-border-subtle);
  border-radius: var(--soma-radius-lg);
}

/* Waveform Visualizer */
.soma-waveform {
  position: relative;
  height: 80px;
  background: var(--soma-bg-muted);
  border-radius: var(--soma-radius-md);
  overflow: hidden;
}

.soma-waveform__canvas {
  width: 100%;
  height: 100%;
}

.soma-waveform--active {
  border: 2px solid var(--soma-primary-500);
}

/* Transcription Display */
.soma-transcription {
  padding: var(--soma-space-4);
  background: var(--soma-bg-muted);
  border-radius: var(--soma-radius-md);
  min-height: 100px;
  max-height: 200px;
  overflow-y: auto;
}

.soma-transcription__text {
  font-size: var(--soma-text-sm);
  line-height: var(--soma-leading-relaxed);
  color: var(--soma-text-primary);
}

.soma-transcription__interim {
  color: var(--soma-text-muted);
  font-style: italic;
}

.soma-transcription__placeholder {
  color: var(--soma-text-muted);
  font-style: italic;
}

/* TTS Progress */
.soma-tts-progress {
  display: flex;
  flex-direction: column;
  gap: var(--soma-space-2);
}

.soma-tts-progress__bar {
  height: 4px;
  background: var(--soma-neutral-200);
  border-radius: var(--soma-radius-full);
  overflow: hidden;
}

.soma-tts-progress__fill {
  height: 100%;
  background: var(--soma-primary-500);
  border-radius: var(--soma-radius-full);
  transition: width 100ms linear;
}

.soma-tts-progress__time {
  display: flex;
  justify-content: space-between;
  font-size: var(--soma-text-xs);
  color: var(--soma-text-muted);
}

/* Voice Button */
.soma-voice-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 64px;
  border-radius: var(--soma-radius-full);
  background: var(--soma-primary-600);
  color: white;
  font-size: 24px;
  transition: all var(--soma-transition-fast);
  box-shadow: var(--soma-shadow-md);
}

.soma-voice-btn:hover {
  background: var(--soma-primary-700);
  transform: scale(1.05);
}

.soma-voice-btn--active {
  background: var(--soma-error-500);
  animation: soma-voice-pulse 1.5s infinite;
}

.soma-voice-btn--sm {
  width: 48px;
  height: 48px;
  font-size: 18px;
}

.soma-voice-btn--lg {
  width: 80px;
  height: 80px;
  font-size: 32px;
}

@keyframes soma-voice-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
  }
  50% {
    box-shadow: 0 0 0 12px rgba(239, 68, 68, 0);
  }
}

/* Voice Controls */
.soma-voice-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--soma-space-4);
}

/* Voice Mode Toggle */
.soma-voice-mode {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
  padding: var(--soma-space-2);
  background: var(--soma-bg-muted);
  border-radius: var(--soma-radius-md);
}

.soma-voice-mode__btn {
  padding: var(--soma-space-2) var(--soma-space-3);
  font-size: var(--soma-text-sm);
  font-weight: var(--soma-font-medium);
  color: var(--soma-text-secondary);
  border-radius: var(--soma-radius-sm);
  transition: all var(--soma-transition-fast);
}

.soma-voice-mode__btn--active {
  background: var(--soma-bg-surface);
  color: var(--soma-text-primary);
  box-shadow: var(--soma-shadow-sm);
}

/* Voice Status */
.soma-voice-status {
  display: flex;
  align-items: center;
  gap: var(--soma-space-2);
  font-size: var(--soma-text-sm);
}

.soma-voice-status__dot {
  width: 8px;
  height: 8px;
  border-radius: var(--soma-radius-full);
}

.soma-voice-status--connected .soma-voice-status__dot {
  background: var(--soma-success-500);
}

.soma-voice-status--connecting .soma-voice-status__dot {
  background: var(--soma-warning-500);
  animation: soma-blink 1s infinite;
}

.soma-voice-status--disconnected .soma-voice-status__dot {
  background: var(--soma-neutral-400);
}

.soma-voice-status--error .soma-voice-status__dot {
  background: var(--soma-error-500);
}

@keyframes soma-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}

/* Voice Processing Indicator */
.soma-voice-processing {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--soma-space-1);
  padding: var(--soma-space-2);
}

.soma-voice-processing__dot {
  width: 8px;
  height: 8px;
  background: var(--soma-primary-500);
  border-radius: var(--soma-radius-full);
  animation: soma-voice-processing-bounce 1.4s infinite ease-in-out both;
}

.soma-voice-processing__dot:nth-child(1) { animation-delay: -0.32s; }
.soma-voice-processing__dot:nth-child(2) { animation-delay: -0.16s; }
.soma-voice-processing__dot:nth-child(3) { animation-delay: 0s; }

@keyframes soma-voice-processing-bounce {
  0%, 80%, 100% {
    transform: scale(0);
  }
  40% {
    transform: scale(1);
  }
}
