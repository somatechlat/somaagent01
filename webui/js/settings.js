const safeToast = (text, error) => {
  if (typeof window !== 'undefined' && typeof window.toastFetchError === 'fi18n.t('ui_undefined') {
    window.toastFetchError(text, erroi18n.t('ui_function')else {
    console.error(text, error);
  }
};

if (typeof window !== 'undefined' && typeof window.toastFetchError !== 'fi18n.t('ui_undefined') {
  window.toastFetchError = safeToast;i18n.t('ui_function')t settingsModalProxy = {
    isOpen: false,
    settings: {},
    resolvePromise: null,
    activeTab: 'agent', // Default tab
    provider: 'cloudflared'i18n.t('ui_agent')  // Computed property fi18n.t('ui18n.t('ui_cloudflared')_window_undefined_typeof_window_toastfi18n.t('ui_if_typeof_window_undefined_typeof_window_toastfetcherror_function_window_toastfetcherror_text_error_else_console_error_text_error_if_typeof_window_undefined_typeof_window_toastfetcherror_function_window_toastfetcherror_safetoast_const_settingsmodalproxy_isopen_false_settings_resolvepromise_null_activetab_agent_default_tab_provider_cloudflared_computed_property_for_filtered_sections_get_filteredsections_if_this_settings_this_settings_sections_return_const_filteredsections_this_settings_sections_filter_section_section_tab_this_activetab_if_no_sections_match_the_current_tab_or_all_tabs_are_missing_show_all_sections_if_filteredsections_length_0_return_this_settings_sections_return_filteredsections_switch_tab_method_switchtab_tabname_update_our_component_state_this_activetab_tabname_update_the_store_safely_const_store_alpine_store_root_if_store_store_activetab_tabname_localstorage_setitem_settingsactivetab_tabname_auto_scroll_active_tab_into_view_after_a_short_delay_to_ensure_dom_updates_settimeout_const_activetab_document_queryselector_settings_tab_active_if_activetab_activetab_scrollintoview_behavior_smooth_block_nearest_inline_center_when_switching_to_the_scheduler_tab_initialize_flatpickr_components_if_tabname_scheduler_debug_switching_to_scheduler_tab_initializing_flatpickr_const_schedulerelement_document_queryselector_x_data_schedulersettings_if_schedulerelement_const_schedulerdata_alpine_data_schedulerelement_if_schedulerdata_polling_removed_initialize_flatpickr_if_editing_or_creating_if_typeof_schedulerdata_initflatpickr_function_check_if_we_re_creating_or_editing_and_initialize_accordingly_if_schedulerdata_iscreating_schedulerdata_initflatpickr_create_else_if_schedulerdata_isediting_schedulerdata_initflatpickr_edit_force_an_immediate_fetch_if_typeof_schedulerdata_fetchtasks_function_schedulerdata_fetchtasks_10_async_openmodal_debug_settings_modal_opening_const_modalel_document_getelementbyid_settingsmodal_const_modalad_modalel_alpine_data_modalel_null_first_ensure_the_store_is_updated_properly_const_store_alpine_store_root_if_store_set_isopen_first_to_ensure_proper_state_store_isopen_true_get_settings_from_backend_try_const_resp_await_fetchapi_v1_settings_if_resp_ok_throw_new_error_await_resp_text_const_payload_await_resp_json_const_sectionspayload_payload_sections_payload_settings_sections_const_configtitle_payload_title_settings_first_load_the_settings_data_without_setting_the_active_tab_const_settings_title_configtitle_buttons_id_save_title_i18n_t_settings_save_classes_btn_btn_ok_id_cancel_title_i18n_t_settings_cancel_type_secondary_classes_btn_btn_cancel_sections_sectionspayload_update_modal_data_if_modalad_modalad_isopen_true_modalad_settings_settings_now_set_the_active_tab_after_the_modal_is_open_this_ensures_alpine_reactivity_works_as_expected_settimeout_get_stored_tab_or_default_to_agent_const_savedtab_localstorage_getitem_settingsactivetab_agent_debug_setting_initial_tab_to_savedtab_directly_set_the_active_tab_if_modalad_modalad_activetab_savedtab_also_update_the_store_if_store_store_activetab_savedtab_localstorage_setitem_settingsactivetab_savedtab_add_a_small_delay_after_setting_the_tab_to_ensure_scrolling_works_settimeout_const_activetabelement_document_queryselector_settings_tab_active_if_activetabelement_activetabelement_scrollintoview_behavior_smooth_block_nearest_inline_center_const_schedulertab_document_queryselector_settings_tab_title_task_scheduler_const_schedulertabactive_schedulertab_schedulertab_classlist_contains_active_polling_removed_just_fetch_if_scheduler_is_active_if_modalad_activetab_scheduler_schedulertabactive_const_schedulerelement_document_queryselector_x_data_schedulersettings_const_schedulerdata_schedulerelement_alpine_data_schedulerelement_if_schedulerdata_typeof_schedulerdata_fetchtasks_function_schedulerdata_fetchtasks_10_small_delay_just_for_scrolling_5_keep_a_minimal_delay_for_modal_opening_reactivity_add_a_watcher_to_disable_the_save_button_when_a_task_is_being_created_or_edited_const_schedulercomponent_document_queryselector_x_data_schedulersettings_if_schedulercomponent_watch_for_changes_to_the_scheduler_s_editing_state_const_checkschedulereditingstate_const_schedulerdata_alpine_data_schedulercomponent_if_schedulerdata_if_we_re_on_the_scheduler_tab_and_creating_editing_a_task_disable_the_save_button_const_savebutton_document_queryselector_modal_footer_button_btn_ok_if_savebutton_modalad_activetab_scheduler_schedulerdata_iscreating_schedulerdata_isediting_savebutton_disabled_true_savebutton_classlist_add_btn_disabled_else_if_savebutton_savebutton_disabled_false_savebutton_classlist_remove_btn_disabled_add_a_mutation_observer_to_detect_changes_in_the_scheduler_component_s_state_const_observer_new_mutationobserver_checkschedulereditingstate_observer_observe_schedulercomponent_attributes_true_subtree_true_childlist_true_also_watch_for_tab_changes_to_update_button_state_modalad_watch_activetab_checkschedulereditingstate_initial_check_settimeout_checkschedulereditingstate_100_return_new_promise_resolve_this_resolvepromise_resolve_catch_e_safetoast_error_getting_settings_e_async_handlebutton_buttonid_if_buttonid_save_const_modalel_document_getelementbyid_settingsmodal_const_modalad_modalel_alpine_data_modalel_null_const_sections_modalad_settings_sections_try_const_response_await_fetchapi_v1_settings_method_post_headers_content_type_application_json_body_json_stringify_sections_if_response_ok_throw_new_error_await_response_text_const_data_await_response_json_const_updatedsections_data_sections_data_settings_sections_if_modalad_array_isarray_updatedsections_updatedsections_length_0_modalad_settings_sections_updatedsections_document_dispatchevent_new_customevent_settings_updated_detail_data_if_typeof_window_toastfrontendsuccess_function_window_toastfrontendsuccess_settings_saved_settings_3_this_resolvepromise_status_saved_data_this_resolvepromise_null_catch_e_window_toastfetcherror_error_saving_settings_e_return_else_if_buttonid_cancel_this_handlecancel_return_polling_removed_first_update_our_component_state_this_isopen_false_then_safely_update_the_store_const_store_alpine_store_root_if_store_use_a_slight_delay_to_avoid_reactivity_issues_settimeout_store_isopen_false_10_async_handlecancel_this_resolvepromise_status_cancelled_data_null_this_resolvepromise_null_polling_removed_first_update_our_component_state_this_isopen_false_then_safely_update_the_store_const_store_alpine_store_root_if_store_use_a_slight_delay_to_avoid_reactivity_issues_settimeout_store_isopen_false_10_prior_polling_helper_removed_async_handlefieldbutton_field_console_log_button_clicked_field_id_if_field_id_mcp_servers_config_openmodal_settings_mcp_client_mcp_servers_html_else_if_field_id_backup_create_openmodal_settings_backup_backup_html_else_if_field_id_backup_restore_openmodal_settings_backup_restore_html_else_if_field_id_show_a2a_connection_openmodal_settings_external_a2a_connection_html_else_if_field_id_external_api_examples_openmodal_settings_external_api_examples_html_else_if_field_id_memory_dashboard_openmodal_settings_memory_memory_dashboard_html_globalthis_settingsmodalproxy_settingsmodalproxy_function_initsettingsmodal_window_opensettings_function_proxy_openmodal_then_result_console_log_result_this_will_log_the_result_when_the_modal_is_closed_return_proxy_document_addeventlistener_alpine_init_alpine_store_settingsmodal_initsettingsmodal_document_addeventlistener_alpine_init_function_initialize_the_root_store_first_to_ensure_it_exists_before_components_try_to_access_it_alpine_store_root_activetab_localstorage_getitem_settingsactivetab_agent_isopen_false_togglesettings_this_isopen_this_isopen_then_initialize_other_alpine_components_alpine_data_settingsmodal_function_return_settingsdata_filteredsections_activetab_agent_isloading_true_async_init_initialize_with_the_store_value_this_activetab_alpine_store_root_activetab_agent_watch_store_tab_changes_this_watch_store_root_activetab_newtab_if_typeof_newtab_undefined_this_activetab_newtab_localstorage_setitem_settingsactivetab_newtab_this_updatefilteredsections_load_settings_await_this_fetchsettings_this_updatefilteredsections_switchtab_tab_update_our_component_state_this_activetab_tab_update_the_store_safely_const_store_alpine_store_root_if_store_store_activetab_tab_async_fetchsettings_try_this_isloading_true_const_response_await_fetchapi_v1_settings_if_response_ok_const_data_await_response_json_if_data_data_sections_this_settingsdata_sections_data_sections_else_console_error_invalid_settings_data_format_else_console_error_failed_to_fetch_settings_response_statustext_catch_error_console_error_error_fetching_settings_error_finally_this_isloading_false_updatefilteredsections_filter_sections_based_on_active_tab_if_this_activetab_agent_this_filteredsections_this_settingsdata_sections_filter_section_section_tab_agent_else_if_this_activetab_external_this_filteredsections_this_settingsdata_sections_filter_section_section_tab_external_else_if_this_activetab_developer_this_filteredsections_this_settingsdata_sections_filter_section_section_tab_developer_else_if_this_activetab_mcp_this_filteredsections_this_settingsdata_sections_filter_section_section_tab_mcp_else_if_this_activetab_backup_this_filteredsections_this_settingsdata_sections_filter_section_section_tab_backup_else_for_any_other_tab_show_nothing_since_those_tabs_have_custom_ui_this_filteredsections_async_savesettings_try_first_validate_for_const_section_of_this_settingsdata_sections_for_const_field_of_section_fields_if_field_required_field_value_field_value_trim_showtoast_field_title_in_section_title_is_required_error_return_prepare_data_const_formdata_for_const_section_of_this_settingsdata_sections_for_const_field_of_section_fields_formdata_field_id_field_value_send_request_const_response_await_fetchapi_api_settings_save_method_post_headers_content_type_application_json_body_json_stringify_formdata_if_response_ok_showtoast_settings_saved_successfully_success_refresh_settings_await_this_fetchsettings_else_const_errordata_await_response_json_throw_new_error_errordata_error_failed_to_save_settings_catch_error_console_error_error_saving_settings_error_showtoast_failed_to_save_settings_error_message_error_handle_special_button_field_actions_handlefieldbutton_field_if_field_action_test_connection_this_testconnection_field_else_if_field_action_reveal_token_this_revealtoken_field_else_if_field_action_generate_token_this_generatetoken_field_else_console_warn_unknown_button_action_field_action_test_api_connection_async_testconnection_field_try_field_testresult_testing_field_teststatus_loading_find_the_api_key_field_let_apikey_for_const_section_of_this_settingsdata_sections_for_const_f_of_section_fields_if_f_id_field_target_apikey_f_value_break_if_apikey_throw_new_error_api_key_is_required_send_test_request_const_response_await_fetchapi_api_test_connection_method_post_headers_content_type_application_json_body_json_stringify_service_field_service_api_key_apikey_const_data_await_response_json_if_response_ok_data_success_field_testresult_connection_successful_field_teststatus_success_else_throw_new_error_data_error_connection_failed_catch_error_console_error_connection_test_failed_error_field_testresult_failed_error_message_field_teststatus_error_reveal_token_temporarily_revealtoken_field_find_target_field_for_const_section_of_this_settingsdata_sections_for_const_f_of_section_fields_if_f_id_field_target_toggle_field_type_f_type_f_type_password_text_password_update_button_text_field_value_f_type_password_show_hide_break_generate_random_token_generatetoken_field_find_target_field_for_const_section_of_this_settingsdata_sections_for_const_f_of_section_fields_if_f_id_field_target_generate_random_token_const_chars_abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz0123456789_let_token_for_let_i_0_i')                         }

                            // Set field value
                            f.value = token;
                            break;
                        }
                    }
                }
            },

            closeModal() {
                // Stop scheduler polling before closing the modal
                const schedulerElement = document.querySelector('[x-data="i18n.t('ui_i18n_t_ui_i18n_t_ui_schedulersi18n.t('ui_x_data_i18n_t')               if (schedulerElemi18n.t('ui_')) {
                    const schedulerData = Alpine.$data(schedulerElement);
                    if (schedulerData && typeof schedulerData.stopPolling === 'function') {
                        coni18n.t('ui_function')('Stopping scheduler polling on modal closi18n.t('ui_stopping_scheduler_polling_on_modal_close')a.stopPolling();
                    }
                }

                this.$store.root.isOpen = false;
            }
        };
    });
});

// Show toast notification - now uses new notification system
function showToast(message, type = 'info') {
    // Use new frontend notifici18n.t('ui_info')n system based on type
    if (window.Alpine && window.Alpine.store && window.Alpine.store('notificationStore')) {
        const stoi18n.t('ui_notificationstore')e.store('notificationStore');
        switch (typi18n.t('ui_notificationstore'){
            case 'error':
                return store.froi18n.t('ui_error')Error(message, "i18n.t('ui_i18n_t_ui_i18n_t_ui_settings')", 5);
i18n.t('ui_i18n_t_ui_settings')cess':
                retui18n.t('ui_success')e.frontendInfo(message, "i18n.t('ui_i18n_t_ui_i18n_t_ui_settingi18n.t('ui_i18n_t_ui_settings') case 'warning':
          i18n.t('ui_warning')eturn store.frontendWarning(message, "i18n.t('ui_i18n_t_ui_i18n_t_i18n.t('ui_i18n_t_ui_settings')           case 'info':
   i18n.t('ui_info')     default:
                return store.frontendInfo(message, "i18n.t('ui_i18n_t_i18n.t('ui_i18n_t_ui_settings')')", 3);
        }
    } else {
        // Fallback if Alpine/store not ready
        console.log(`i18n.t('ui_settings_type_touppercase_message')`);
        return null;
    }
}
