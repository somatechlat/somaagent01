{
  "openapi": "3.1.0",
  "info": {
    "title": "SomaBrain - Cognitive AI System",
    "description": "Low-latency cognitive services with strict production-mode enforcement.",
    "version": "1"
  },
  "paths": {
    "/neuromodulators": {
      "get": {
        "summary": "Get Neuromodulators",
        "operationId": "get_neuromodulators_neuromodulators_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NeuromodStateModel"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Set Neuromodulators",
        "operationId": "set_neuromodulators_neuromodulators_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NeuromodStateModel"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NeuromodStateModel"
                }
              }
            }
          }
        }
      }
    },
    "/context/adaptation/state": {
      "get": {
        "summary": "Adaptation State Endpoint",
        "description": "Return current adaptation weights (retrieval + utility) and history length.",
        "operationId": "adaptation_state_endpoint_context_adaptation_state_get",
        "parameters": [
          {
            "name": "tenant_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [{"type": "string"}, {"type": "null"}],
              "title": "Tenant Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdaptationStateResponse"
                }
              }
            }
          }
        }
      }
    },
    "/context/adaptation/reset": {
      "post": {
        "summary": "Adaptation Reset Endpoint",
        "description": "Reset the per-tenant adaptation engine to defaults for clean benchmarks.",
        "operationId": "adaptation_reset_endpoint_context_adaptation_reset_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetAdaptationRequest"
              }
            }
          },
          "required": true
        }
      }
    },
    "/sleep/run": {
      "post": {
        "summary": "Sleep Run",
        "operationId": "sleep_run_sleep_run_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SleepRunRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SleepRunResponse"
                }
              }
            }
          }
        }
      }
    },
    "/sleep/status": {
      "get": {
        "summary": "Sleep Status",
        "operationId": "sleep_status_sleep_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SleepStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/util/sleep": {
      "post": {
        "summary": "Util Sleep",
        "description": "Transition a tenant's sleep state.",
        "operationId": "util_sleep_api_util_sleep_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SleepRequest"
              }
            }
          },
          "required": true
        }
      }
    },
    "/api/brain/sleep_mode": {
      "post": {
        "summary": "Brain Sleep",
        "description": "Cognitive-level sleep state transition.",
        "operationId": "brain_sleep_api_brain_sleep_mode_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SleepRequest"
              }
            }
          },
          "required": true
        }
      }
    },
    "/remember": {
      "post": {
        "summary": "Remember",
        "description": "Handle memory storage.",
        "operationId": "remember_remember_post"
      }
    },
    "/recall": {
      "post": {
        "summary": "Recall",
        "operationId": "recall_recall_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecallRequest"
              }
            }
          },
          "required": true
        }
      }
    },
    "/delete": {
      "post": {
        "summary": "Delete Memory",
        "operationId": "delete_memory_delete_post"
      }
    },
    "/context/evaluate": {
      "post": {
        "summary": "Evaluate Endpoint",
        "operationId": "evaluate_endpoint_context_evaluate_post"
      }
    },
    "/context/feedback": {
      "post": {
        "summary": "Feedback Endpoint",
        "operationId": "feedback_endpoint_context_feedback_post"
      }
    },
    "/persona/{pid}": {
      "put": {
        "summary": "Put Persona",
        "description": "Create or update a Persona record."
      },
      "get": {
        "summary": "Get Persona",
        "description": "Retrieve the latest Persona record for pid."
      },
      "delete": {
        "summary": "Delete Persona"
      }
    },
    "/health": {
      "get": {
        "summary": "Health",
        "description": "Public health endpoint."
      }
    },
    "/plan/suggest": {
      "post": {
        "summary": "Plan Suggest",
        "description": "Suggest a small plan derived from the semantic graph around a task key."
      }
    },
    "/personality": {
      "post": {
        "summary": "Set Personality",
        "operationId": "set_personality_personality_post"
      }
    },
    "/act": {
      "post": {
        "summary": "Act Endpoint",
        "description": "Execute an action/task and return step results."
      }
    }
  },
  "components": {
    "schemas": {
      "NeuromodStateModel": {
        "properties": {
          "dopamine": {"type": "number", "title": "Dopamine", "default": 0.4},
          "serotonin": {"type": "number", "title": "Serotonin", "default": 0.5},
          "noradrenaline": {"type": "number", "title": "Noradrenaline", "default": 0.0},
          "acetylcholine": {"type": "number", "title": "Acetylcholine", "default": 0.0}
        },
        "type": "object",
        "title": "NeuromodStateModel"
      },
      "AdaptationStateResponse": {
        "properties": {
          "retrieval": {"$ref": "#/components/schemas/RetrievalWeightsState"},
          "utility": {"$ref": "#/components/schemas/UtilityWeightsState"},
          "history_len": {"type": "integer"},
          "learning_rate": {"type": "number"},
          "gains": {"$ref": "#/components/schemas/AdaptationGainsState"},
          "constraints": {"$ref": "#/components/schemas/AdaptationConstraintsState"}
        },
        "type": "object",
        "required": ["retrieval", "utility", "history_len", "learning_rate", "gains", "constraints"],
        "title": "AdaptationStateResponse"
      },
      "SleepRunRequest": {
        "properties": {
          "nrem": {"anyOf": [{"type": "boolean"}, {"type": "null"}], "default": true},
          "rem": {"anyOf": [{"type": "boolean"}, {"type": "null"}], "default": true}
        },
        "type": "object",
        "title": "SleepRunRequest"
      },
      "SleepRunResponse": {
        "properties": {
          "ok": {"type": "boolean", "description": "Whether the sleep run started successfully"},
          "run_id": {"anyOf": [{"type": "string"}, {"type": "null"}], "description": "Identifier for the initiated sleep run"}
        },
        "type": "object",
        "required": ["ok"],
        "title": "SleepRunResponse"
      },
      "SleepRequest": {
        "properties": {
          "target_state": {"$ref": "#/components/schemas/SleepTargetState"},
          "ttl_seconds": {"anyOf": [{"type": "integer", "minimum": 1}, {"type": "null"}]},
          "async_mode": {"type": "boolean", "default": false},
          "trace_id": {"anyOf": [{"type": "string"}, {"type": "null"}]}
        },
        "type": "object",
        "required": ["target_state"],
        "title": "SleepRequest"
      },
      "SleepTargetState": {
        "type": "string",
        "enum": ["active", "light", "deep", "freeze"],
        "title": "SleepTargetState"
      },
      "RecallRequest": {
        "properties": {
          "query": {"type": "string"},
          "top_k": {"type": "integer", "default": 3},
          "universe": {"anyOf": [{"type": "string"}, {"type": "null"}]}
        },
        "type": "object",
        "required": ["query"],
        "title": "RecallRequest"
      }
    }
  }
}
